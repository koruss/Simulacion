/*
TAREA 3
Kenneth Corrales Lizano carnet 2017151342
Alejandro Tapia Alvarez carnet 2017116952


Para el documento n = 1000 
el resultado del ChiCuadrado es igual a chiCuad: 1.4589947089947104 

Codigo del Programa
*/

clearoutput


/*
Esta funcion toma un numero y convierte su parte decimal en una lista 
*/ 
newcmd explotar dec num lista
   decMasUno = dec + 1
   res = ()
   t = num * 10^decMasUno
   /* integer round t t */
   integer truncate t t
	/*
	print num
	print t
	*/
   integer truncate t t
   numCiclos = decMasUno
   repeat numCiclos
      rem = t % 10
      quo = t / 10
      integer truncate quo quo
      t = quo
      concat rem res res
   end
   take res 1,dec lista
end

/*
Lee un archivo
*/
newcmd leerArchivo archivo cantNumeros
   READ file "" archivo
   size archivo cantNumeros
end


/*
Al inicio se asume que todas las cartas son diferentes
*/
newcmd procesarMano mano fo
   	pos = 1
	'Caso de un par y full house
   	multiples  mano =2 repetidos
   	if(repetidos = 1)
			'Caso Full House
     		multiples mano =3 repetidos
      		if (repetidos =1)
			pos = 5
		'Caso un par
		else
			pos =2
		end
	'Caso Dos Pares
	elseif( repetidos =2)
		pos =3
	else
		'Tres iguales
		multiples mano =3 repetidos
		if (repetidos = 1)
			pos =4
		else 
			'Caso cuatro iguales
			multiples mano =4 repetidos
			if (repetidos = 1)
				pos =6
			else
				'Caso Quintilla		
				multiples mano =5 repetidos
				if (repetidos = 1)
					pos =7
				end
			end
         	end
         
         
         
     	 end
'Aumentamos el valor de fo de acuerdo al caso
	take fo pos temp
	temp = temp +1
	put temp pos fo     
end
   

  
/*

          ----   Programa Principal ------------

*/
   
   
/*
Variables utilizadas
*/
   decimales = 5
   archivo = 0
   cantNumeros = 0
   res = 0
   leerArchivo archivo cantNumeros
   pX = (0.3024 0.5040 0.1080 0.0720 0.0090 0.0045 0.0001)
   fe = pX * cantNumeros 
   copy 7#0 fo
   name Diferente UnPar DosPares Trio FullHouse Poker Quintilla
   bin = (Diferente UnPar DosPares Trio FullHouse Poker Quintilla)   


   
'Genera la lista de todos los decimales concatenados
   foreach numero archivo
      explotar decimales numero res
      procesarMano res fo
   end
 

'Genera la lista de fo vacia con ceros
chiSquare fo fe  chiCuad




'imprime la tabla final de los valores utilizados
print table  bin fo%8.8F fe%8.8F
print
'imprime el valor del Chi Cuadrado obtenido
print chiCuad   

